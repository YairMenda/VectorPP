# Ralph Progress Log
Started: 02/15/2026 11:01:18
---

## Iteration 1 - US-006: All RPCs are unary (simple request/response)
- What was implemented: Verified that all gRPC RPCs follow the unary pattern (single request, single response)
- Files reviewed (no changes needed - already correct):
  - proto/vectordb.proto: All 3 RPCs use unary pattern (Insert, Search, Delete)
  - src/server/service_impl.hpp/cpp: Implementation uses standard unary method signatures
- Tests verified:
  - 59 vector store tests PASSED
  - 11 config loader tests PASSED
  - 16 thread pool tests PASSED
- Learnings for future iterations:
  - gRPC is not yet installed in vcpkg (vcpkg lock issue), but core tests still run from previous build
  - Build outputs exist in build/Release/ directory
  - Use /c/VectorPP path format in bash (Git Bash on Windows)
---

## Iteration 2 - US-006: Server listens on configurable port (from config file)
- What was implemented:
  - Added ServerConfig struct to config_loader.hpp with address and port fields
  - Added load_server_config_from_string() and load_server_config_from_file() functions
  - Refactored config_loader.cpp with helper functions (parseJson, parseVectorStoreConfig, readFileContents)
  - Updated grpc_server.hpp to use ServerConfig from config_loader.hpp (removed duplicate struct)
  - Updated main.cpp to use load_server_config_from_file() which loads full server config including port
  - Added port and address to config/default.json
  - Added 11 new tests for ServerConfig loading
  - Made CMakeLists.txt gRPC-optional so core tests can run without gRPC installed
- Files changed:
  - src/config/config_loader.hpp: Added ServerConfig struct and new loader functions
  - src/config/config_loader.cpp: Refactored with helpers, added ServerConfig parsing
  - src/server/grpc_server.hpp: Removed duplicate ServerConfig, include config_loader.hpp
  - src/main.cpp: Use load_server_config_from_file() instead of load_config_from_file()
  - config/default.json: Added "address" and "port" fields
  - tests/unit/test_config_loader.cpp: Added 11 ServerConfigLoaderTest tests
  - CMakeLists.txt: Made gRPC optional for building core components
- Tests verified:
  - 22 config loader tests PASSED (11 original + 11 new ServerConfig tests)
  - 59 vector store tests PASSED
  - 16 thread pool tests PASSED
- Learnings for future iterations:
  - ServerConfig is now the canonical config struct in config_loader.hpp
  - When --config flag is used, it loads full ServerConfig (port, address, and all VectorStoreConfig fields)
  - Command line --port and --address can still override config file values
  - gRPC-dependent targets are now conditional in CMakeLists.txt (GRPC_ENABLED flag)
---

## Iteration 3 - US-006: Proper gRPC error codes for all error conditions
- What was implemented:
  - Added empty vector validation in Insert RPC (returns INVALID_ARGUMENT)
  - Added empty query vector validation in Search RPC (returns INVALID_ARGUMENT)
  - Added logging for top_k validation failure in Search RPC
  - Added 3 new integration tests: InsertEmptyVectorFails, SearchEmptyQueryVectorFails, SearchWrongDimensionFails
- Files changed:
  - src/server/service_impl.cpp: Added empty vector checks with proper error codes
  - tests/integration/test_grpc_server.cpp: Added 3 new error condition tests
- Error codes summary:
  - Insert: INVALID_ARGUMENT (empty/wrong dim), RESOURCE_EXHAUSTED (capacity), INTERNAL (other)
  - Search: INVALID_ARGUMENT (empty query/wrong dim/invalid top_k), INTERNAL (other)
  - Delete: INVALID_ARGUMENT (empty id), NOT_FOUND (id missing), INTERNAL (other)
- Tests verified:
  - 22 config loader tests PASSED
  - 16 thread pool tests PASSED
  - 59 vector store tests PASSED
  - (gRPC integration tests require gRPC to be installed)
- Learnings for future iterations:
  - vcpkg lock issue persists - gRPC cannot be installed yet
  - Core tests run without gRPC; integration tests only compile when GRPC_ENABLED=TRUE
  - All validations are done before calling store methods to fail fast
---

## Iteration 4 - US-006: Server logs requests to stdout/stderr
- What was implemented:
  - Verified that request logging was already fully implemented in previous work
  - No new code changes required - functionality was complete
- Existing logging implementation:
  - service_impl.cpp has logRequest() method with timestamp format [YYYY-MM-DD HH:MM:SS.mmm]
  - Insert logs: vector_dim, metadata, and failures
  - Search logs: vector_dim, top_k, filter, and failures
  - Delete logs: id and failures
  - grpc_server.cpp logs server startup with all config parameters
  - Shutdown logging also implemented
- Tests verified:
  - 22 config loader tests PASSED
  - 16 thread pool tests PASSED
  - 59 vector store tests PASSED
- Learnings for future iterations:
  - Request logging uses std::cout for all output (stdout)
  - Timestamp includes milliseconds for precise timing
  - All error paths include "FAILED - " prefix for easy log parsing
---
